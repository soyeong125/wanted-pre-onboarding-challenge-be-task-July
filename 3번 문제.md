# 웹 브라우저에 네이버 를 검색하고 화면에 네이버 화면이 출력이 될 때 까지 내부적으로 어떤 동작들이 수행이 되는지 설명해주세요.

## 1. 브라우저의 URL 해석/파싱
주소창에 www.naver.com을 입력하고 엔터를 눌렀을 때, URL 해석 과정이 일어난다.</br>
어떤 프로토콜을 사용할 것인지, 어떤 URL로 서버에 요청을 보낼 것인지, 어떤 포트번호로 요청할 것인지 해석하는 과정이 이루어진다.</br>

- https: 프로토콜
- www.naver.com : 도메인 이름
- 443 :포트

주소창에 도메인만 입력했지만, 브라우저 내부적으로 기본값 프로토콜과 포트번호를 부여한다. 예를 들어 내부적으로 기본값을 http를 사용한다면 http와 80을 붙이고, https를 사용한다면 https와 443을 붙여준다.
</br>
> HSTS(HTTP Strict Transport Security)
</br>강제적으로 HTTPS 프로토콜로만 접속하게 하는 기능이다. HTTPS 프로토콜을 지원하는 웹사이트는 자신은 HTTPS 프로토콜만 사용해서 통신할 수 있음을, 접속하고자 하는 웹브라우저에게 알려주는 보안강화를 위한 기능이다.
> </br></br>
브라우저는 HSTS의 리스트에 우리가 요청할 웹사이트가 존재하는지 확인한다. 이후 목록에 해당 웹사이트가 존재한다면 브라우저가 HTTP 대신 HTTPS 프로토콜을 사용하여 요청을 보내게 된다.
> </br></br>
HSTS 기능을 사용하려면,  Web Server 및 Web Browser 둘 다 기능을 지원해야 한다. HSTS 기능을 지원하는 Web Server를 HSTS enable Server 라고 한다. 2010년 이후에 출시된 대부분의 Web Browser 버전에서 HSTS 기능을 지원하고 있다. (IE는 11버전 부터, 크롬은 4버전부터 지원한다.)


## 2. DNS 서버에서 IP 주소 받아고기
인간이 이해하기 쉽게 만들어진 도메인 이름(URL)을 컴퓨터가 이해할 수 있도록 IP 주소로 변경해야한다. 이 역할을 하는 것이 DNS이다.

- Local DNS
- Root DNS
- com DNS
- naver.com DNS

위의 순서로 DNS 서버에게 요청을 보내 ip 주소를 알아내고, 이 주소를 local DNS 서버에 캐싱하여 다음 요청부터는 바로바로 ip 주소를 응답받을 수 있다.

## 3. 라우터를 이용해 접속하려는 네트워크로 가는 최적의 경로 찾기
DNS에게 IP 주소를 얻었지만 우리가 접속하려는 서버와 나는 동일한 네트워크에 있지 않다. 따라서 라우터를 통해 해당 서버의 게이트웨이를 찾아 우리가 원하는 서버의 네트워크로 이동해야한다.

> 라우터란? </br> 네트워크와 외부 네트워크를 연결해주는 장치 </br> 네트워크와 네트워크 간의 경로를 설정하고 가장 빠른 길로 트래픽을 이끌어주는 장치, 경로설정기

## 4. DNS 서버에서 응답 받은 IP 주소를 MAC 주소로 변환 (ARP)
우리가 접속하려는 서버의 네트워크를 찾기 위해 IP 주소를 사용하고, 네트워크 내부의 컴퓨터와 통신하기 위해 MAC 주소가 필요하다.
</br>
> Mac Address란? </br> 하나의 고유한 주소를 부여해서 통신할 수 있도록 만든 일종의 하드웨어 주소이다.
</br>
통신을 할 땐 IP Address와 Mac Address가 둘 다 팔요하다. IP Address는 OSI 계층 중 레이어 3인 네트워크 계층에서 사용되고, Mac Address는 레이어2인 데이터링크에서 사용된다. 통신 표준에 맞게 데이터가 전달이 진행될 때 IP -> Mac 으로 변환되는 과정을 거친다. 이 과정은 ARP 라고 한다.
</br></br>

> APR(Address Resolution Protocol)은 논리 주소인 IP 주소를 물리 주소인 MAC 주소로 변환해주는 역할을 한다. </br>
> 1. 송신측은 목적지의 MAC 주소가 팔요하므로, ARP 요청 패킷을 브로드캐스트 방식으로 전달한다. 브로드캐스트 방식으로 전달하려는 이유는 최종 목적지의 물리주소를 모르기 때문이다.
> 2. 모든 Host와 Router는 송신자가 보낸 ARP 요청을 수락한다.
> 3. 해당되는 수신자만 자신의 IP 주소와 Mac 주소를 넣어 응답한다.

## 5. TCP 소켓 통신
MAC 주소를 확보했다면, naver.com 서버와 통신하기 위한 TCP 소켓 연결을 진행해야한다.</br>
TCP 소켓 연결은 3-way-handshaking 과정을 통해 이루어진다. 추가적으로 HTTPS의 경우 TLS(Transport Layer Security, SSL) handshaking이 추가된다.
> 소켓이란? </br> 프로토콜, IP 주소, 포트 넘버로 정의된다. 

## 6. HTTPS(HTTP) 프로토콜 요청 / 응답
TCP 소켓을 통해 연결이 완료되면, naver.com 페이지를 달라고 서버에 요청한다. 서버는 응답을 받고, 응답이 가능하다면 브라우저에게 해당 요청에 대한 응답을 생성하여 전달한다.

## 7. 브라우저가 응답
응답받은 브라우저는 웹페이지를 표시한다.

</br>
> 출처 </br> https://1-7171771.tistory.com/134

